<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Virtual Neurology OPD | Dr Nisa Raisani</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  padding: 15px;
  margin: 0;
}
.container {
  max-width: 1000px;
  margin: auto;
  background: #fff;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 6px 18px rgba(0,0,0,.1);
}
h2, h3 {
  text-align: center;
  color: #003366;
}
label {
  display: block;
  margin-top: 12px;
  font-weight: bold;
}
input, select, button {
  width: 100%;
  padding: 10px;
  margin-top: 6px;
  box-sizing: border-box;
}
button {
  background: #003366;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  margin-top: 12px;
}
button:hover {
  background: #002244;
}
.result {
  margin-top: 20px;
  padding: 18px;
  border-radius: 10px;
}
.high { background: #ffe0e0; }
.moderate { background: #fff3cd; }
.low { background: #e6f4ea; }
.box {
  background: #f2f2f2;
  padding: 10px;
  border-radius: 6px;
  margin-top: 10px;
}
canvas {
  margin-top: 20px;
  width: 100%;
  height: 200px;
  border: 1px solid #ddd;
}
small {
  color: #555;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  font-size: 14px;
  text-align: center;
}
th { background: #003366; color: #fff; }
.search { margin-top: 15px; }
.note {
  background:#fff3cd;
  color:#856404;
  border-left:5px solid #ffc107;
  padding:15px;
  margin-top:20px;
  border-radius:8px;
  font-size:14px;
  line-height:1.5;
}
@media(max-width:600px){
  canvas { height: 150px; }
}
</style>
</head>

<body>
<div class="container">

<h2 id="title">Virtual Neurology OPD</h2>
<p style="text-align:center"><b>Dr Nisa Raisani</b><br>Neurologist</p>

<div class="box">
<b>Patient ID:</b> <span id="pid"></span>
</div>

<label for="language" id="languageLabel">Language / زبان</label>
<select id="language" onchange="setLanguage()">
<option value="en">English</option>
<option value="ur">اردو</option>
</select>

<label for="age" id="ageLabel">Age</label>
<input type="number" id="age">

<label for="symptom" id="symptomLabel">Main Symptom</label>
<select id="symptom">
<option value="">Select / منتخب کریں</option>
<option value="Seizure">Seizure / دورہ</option>
<option value="Sudden Weakness">Sudden Weakness / اچانک کمزوری</option>
<option value="Speech Difficulty">Speech Difficulty / بولنے میں مشکل</option>
<option value="Headache">Chronic Headache / مسلسل سر درد</option>
<option value="Numbness">Numbness or Tingling / سن ہونا</option>
<option value="Tremor">Tremor / کپکپی</option>
<option value="Memory">Memory Problems / یادداشت کی کمزوری</option>
</select>

<label for="duration" id="durationLabel">Duration</label>
<select id="duration">
<option value="">Select</option>
<option>Few Hours</option>
<option>Few Days</option>
<option>Several Weeks</option>
</select>

<button onclick="runAssessment()" id="assessBtn">Run Assessment</button>
<button onclick="printReferral()" id="refBtn">Print Referral Slip</button>

<div id="output"></div>

<h3 id="dashTitle">Patient Dashboard</h3>
<canvas id="chart"></canvas>

<h3>Saved Patient Records</h3>
<div class="search">
<input type="text" id="searchId" placeholder="Search by Patient ID">
<button onclick="searchPatient()">Search</button>
<button onclick="loadHistory()">Show All</button>
</div>

<table>
<thead>
<tr>
<th>Patient ID</th>
<th>Age</th>
<th>Symptom</th>
<th>Probable Disease</th>
<th>Risk</th>
<th>Date</th>
</tr>
</thead>
<tbody id="history"></tbody>
</table>

<!-- Legal / Professional Note -->
<div class="note">
<b>Note / نوٹ:</b> This tool is intended solely for educational and guidance purposes and <u>does not provide a complete diagnosis or treatment plan</u>. Always consult a qualified medical professional for personal medical advice. <br>
یہ سہولت صرف رہنمائی اور تعلیمی مقاصد کے لیے ہے اور مکمل تشخیص یا علاج فراہم نہیں کرتی۔ ذاتی طبی مشورے کے لیے ہمیشہ مستند ڈاکٹر سے رجوع کریں۔
</div>

<footer><small id="disclaimer">
This tool provides clinical guidance only and does not replace physical examination or emergency care.
</small></footer>

</div>

<script>
// ================= PATIENT ID =================
function generatePatientID(){
  const timestamp = Date.now().toString().slice(-6);
  pid.innerText = "VNOPD-" + timestamp;
}
generatePatientID();

// ================= LANGUAGE =================
const TEXT={
en:{
 title:"Virtual Neurology OPD", age:"Age", symptom:"Main Symptom", duration:"Duration",
 assess:"Run Assessment", referral:"Print Referral Slip", dashboard:"Patient Dashboard",
 disclaimer:"This tool provides clinical guidance only and does not replace physical examination or emergency care.",
 high:"Immediate emergency evaluation is required.",
 moderate:"Neurology OPD consultation is advised.",
 low:"Monitor symptoms and follow up if needed."
},
ur:{
 title:"ورچوئل نیورولوجی او پی ڈی", age:"عمر", symptom:"اہم علامت", duration:"دورانیہ",
 assess:"جائزہ کریں", referral:"ریفرل سلپ پرنٹ کریں", dashboard:"مریض ڈیش بورڈ",
 disclaimer:"یہ سہولت صرف رہنمائی کے لیے ہے اور ایمرجنسی کا متبادل نہیں۔",
 high:"فوراً قریبی ایمرجنسی میں رجوع کریں۔",
 moderate:"نیورولوجی او پی ڈی سے رجوع کریں۔",
 low:"علامات پر نظر رکھیں۔"
}
};

function setLanguage(){
  let l = language.value;
  title.innerText = TEXT[l].title;
  ageLabel.innerText = TEXT[l].age;
  symptomLabel.innerText = TEXT[l].symptom;
  durationLabel.innerText = TEXT[l].duration;
  assessBtn.innerText = TEXT[l].assess;
  refBtn.innerText = TEXT[l].referral;
  dashTitle.innerText = TEXT[l].dashboard;
  disclaimer.innerText = TEXT[l].disclaimer;
  if(window.lastResult){
    output.innerHTML = `<div class="result ${window.lastResult.r.css}">
      <b>Risk:</b> ${window.lastResult.r.level}<br>
      <b>Probable Condition:</b> ${window.lastResult.d}<br><br>
      ${TEXT[l][window.lastResult.r.level.toLowerCase()] || ""}
    </div>`;
  }
}

// ================= NEURO LOGIC =================
function assessRisk(s){
  if(s==="Seizure"||s==="Sudden Weakness"||s==="Speech Difficulty")
    return {level:"HIGH", css:"high"};
  if(s==="Headache"||s==="Numbness"||s==="Memory"||s==="Tremor")
    return {level:"MODERATE", css:"moderate"};
  return {level:"LOW", css:"low"};
}

function detectDisease(s){
  return {
   "Seizure":"Seizure (Event) – cause needs evaluation",
   "Sudden Weakness":"Possible Stroke",
   "Speech Difficulty":"Possible Stroke",
   "Headache":"Migraine",
   "Numbness":"Peripheral Neuropathy",
   "Tremor":"Parkinsonism",
   "Memory":"Cognitive Disorder / Dementia"
  }[s] || "Neurological Condition";
}

// ================= DASHBOARD =================
let stats={HIGH:0,MODERATE:0,LOW:0};
function drawChart(){
  let ctx = chart.getContext("2d");
  ctx.clearRect(0,0,chart.width,chart.height);
  const data=[stats.HIGH, stats.MODERATE, stats.LOW];
  const colors=["#ff6b6b","#f1c40f","#2ecc71"];
  const labels=["High","Moderate","Low"];
  const maxVal = Math.max(...data,1);
  const chartHeight = chart.height - 50;
  let x = 50;
  data.forEach((v,i)=>{
    const barHeight = (v/maxVal)*chartHeight;
    ctx.fillStyle = colors[i];
    ctx.fillRect(x, chart.height - barHeight - 30, 50, barHeight);
    ctx.fillStyle = "#000";
    ctx.fillText(labels[i], x, chart.height - 10);
    ctx.fillText(v, x+15, chart.height - barHeight - 35);
    x += 140;
  });
}

// ================= STORAGE =================
function saveRecord(r){
  let data = JSON.parse(localStorage.getItem("VNOPD_RECORDS")) || [];
  data.push(r);
  localStorage.setItem("VNOPD_RECORDS", JSON.stringify(data));
  localStorage.setItem("VNOPD_LASTRESULT", JSON.stringify(window.lastResult));
  loadHistory();
}

function loadHistory(){
  let data = JSON.parse(localStorage.getItem("VNOPD_RECORDS")) || [];
  history.innerHTML = "";
  data.forEach(r=>{
    history.innerHTML += `<tr>
      <td>${r.patient_id}</td>
      <td>${r.age}</td>
      <td>${r.symptom}</td>
      <td>${r.disease}</td>
      <td>${r.risk}</td>
      <td>${r.date}</td>
    </tr>`;
  });
}

function searchPatient(){
  let id = searchId.value.trim().toUpperCase();
  let data = JSON.parse(localStorage.getItem("VNOPD_RECORDS")) || [];
  let r = data.find(x=>x.patient_id.toUpperCase()===id);
  history.innerHTML = r ?
    `<tr>
      <td>${r.patient_id}</td>
      <td>${r.age}</td>
      <td>${r.symptom}</td>
      <td>${r.disease}</td>
      <td>${r.risk}</td>
      <td>${r.date}</td>
    </tr>` :
    "<tr><td colspan='6'>No record found</td></tr>";
}

// ================= MAIN =================
function runAssessment(){
  let a = age.value, s = symptom.value, l = language.value, dur = duration.value;
  if(!a || !s){ alert("Complete all fields"); return; }
  let r = assessRisk(s);
  let d = detectDisease(s);
  stats[r.level]++; drawChart();
  window.lastResult = {a,s,d,r,duration:dur};
  output.innerHTML = `<div class="result ${r.css}">
    <b>Risk:</b> ${r.level}<br>
    <b>Probable Condition:</b> ${d}<br><br>
    ${TEXT[l][r.level.toLowerCase()] || ""}
  </div>`;
  saveRecord({
    patient_id: pid.innerText,
    age: a,
    symptom: s,
    disease: d,
    risk: r.level,
    duration: dur,
    date: new Date().toLocaleString()
  });
}

// ================= REFERRAL =================
function printReferral(){
  if(!window.lastResult){ alert("Run assessment first"); return; }
  let w = window.open("");
  w.document.write(`<pre>
Referral Slip
-------------------------
Patient ID: ${pid.innerText}
Age: ${window.lastResult.a}
Symptom: ${window.lastResult.s}
Duration: ${window.lastResult.duration || "N/A"}
Probable Condition: ${window.lastResult.d}
Risk: ${window.lastResult.r.level}
Date: ${new Date().toLocaleString()}

Recommendation:
Immediate neurological evaluation advised

Virtual Neurology OPD
Dr Nisa Raisani
-------------------------
</pre>`);
  w.print();
}

// ================= INIT =================
setLanguage();
loadHistory();
window.addEventListener("load",()=>{
  const last = JSON.parse(localStorage.getItem("VNOPD_LASTRESULT"));
  if(last){ window.lastResult = last; setLanguage(); }
});
</script>

</body>
</html>
